# 6ì¼ì°¨: ë¹Œë“œ ì‹œìŠ¤í…œê³¼ Webpack êµ¬ì„±

## í•™ìŠµ ëª©í‘œ
- Webpack ì„¤ì • íŒŒì¼ì˜ ì—­í• ê³¼ êµ¬ì¡°ë¥¼ ì´í•´í•œë‹¤
- Main Processì™€ Renderer Process ë¹Œë“œì˜ ì°¨ì´ì ì„ íŒŒì•…í•œë‹¤
- ê°œë°œ í™˜ê²½ê³¼ í”„ë¡œë•ì…˜ í™˜ê²½ì˜ ìµœì í™” ì „ëµì„ í•™ìŠµí•œë‹¤
- Hot Module Replacement (HMR)ì˜ ë™ì‘ ì›ë¦¬ë¥¼ ì´í•´í•œë‹¤

## ì´ë¡  í•™ìŠµ

### Electronì˜ ì´ì¤‘ ë¹Œë“œ ì‹œìŠ¤í…œ

Electron ì•±ì€ ë‘ ê°œì˜ ë³„ë„ JavaScript í™˜ê²½ì—ì„œ ì‹¤í–‰ë˜ê¸° ë•Œë¬¸ì—, ê°ê°ì— ë§ëŠ” ë¹Œë“œ ì„¤ì •ì´ í•„ìš”í•©ë‹ˆë‹¤:

#### 1. Main Process ë¹Œë“œ (Node.js í™˜ê²½)
- **Target**: `electron-main`
- **í™˜ê²½**: Node.js runtime
- **íŠ¹ì§•**: CommonJS, Node.js API ì ‘ê·¼ ê°€ëŠ¥
- **ë²ˆë“¤ë§**: ì™¸ë¶€ dependencies ì œì™¸ (externals)

#### 2. Renderer Process ë¹Œë“œ (ë¸Œë¼ìš°ì € í™˜ê²½)  
- **Target**: `electron-renderer`
- **í™˜ê²½**: Chromium browser
- **íŠ¹ì§•**: ES modules, ì›¹ API ì ‘ê·¼
- **ë²ˆë“¤ë§**: ëª¨ë“  dependencies í¬í•¨

### ê°œë°œ vs í”„ë¡œë•ì…˜ í™˜ê²½

| êµ¬ë¶„ | ê°œë°œ í™˜ê²½ | í”„ë¡œë•ì…˜ í™˜ê²½ |
|------|-----------|---------------|
| **ì†ŒìŠ¤ë§µ** | ì „ì²´ ì†ŒìŠ¤ë§µ | ì••ì¶•ëœ ì†ŒìŠ¤ë§µ |
| **ì••ì¶•** | ì—†ìŒ | ìµœëŒ€ ì••ì¶• |
| **HMR** | í™œì„±í™” | ë¹„í™œì„±í™” |
| **ë””ë²„ê¹…** | DevTools ìë™ ì—´ë¦¼ | ë¹„í™œì„±í™” |
| **ë²ˆë“¤ í¬ê¸°** | í° í¬ê¸° | ìµœì†Œ í¬ê¸° |

## ì½”ë“œ ë¶„ì„

### webpack.main.config.js ìƒì„¸ ë¶„ì„

```javascript
const path = require('path');

module.exports = {
  // ğŸ¯ ì§„ì…ì  ì„¤ì •
  entry: {
    main: './src/main/main.ts',      // Main Process ì§„ì…ì 
    preload: './src/main/preload.ts' // Preload Script
  },
  
  // ğŸ¯ ë¹Œë“œ íƒ€ê²Ÿ - Node.js í™˜ê²½
  target: 'electron-main',
  
  // ğŸ¯ í™˜ê²½ë³„ ëª¨ë“œ ì„¤ì •
  mode: process.env.NODE_ENV || 'development',
  
  // ğŸ¯ ê°œë°œìš© ì†ŒìŠ¤ë§µ (ë””ë²„ê¹… ìš©ì´)
  devtool: process.env.NODE_ENV === 'development' ? 'source-map' : false,
  
  // ğŸ¯ TypeScript ì²˜ë¦¬
  module: {
    rules: [
      {
        test: /\.ts$/,
        include: /src/,
        use: [{ loader: 'ts-loader' }]
      }
    ]
  },
  
  // ğŸ¯ ì¶œë ¥ ì„¤ì •
  output: {
    path: path.resolve(__dirname, 'dist'),
    filename: '[name].js'  // main.js, preload.js ìƒì„±
  },
  
  // ğŸ¯ ëª¨ë“ˆ í•´ì„ ì„¤ì •
  resolve: {
    extensions: ['.ts', '.js'],
    alias: {
      '@': path.resolve(__dirname, 'src'),
      '@main': path.resolve(__dirname, 'src/main'),
      '@renderer': path.resolve(__dirname, 'src/renderer'),
      '@shared': path.resolve(__dirname, 'src/shared')
    }
  },
  
  // ğŸ¯ Node.js í™˜ê²½ ì„¤ì • ìœ ì§€
  node: {
    __dirname: false,  // __dirnameì„ ì‹¤ì œ ê°’ìœ¼ë¡œ ìœ ì§€
    __filename: false
  },
  
  // ğŸ¯ ì™¸ë¶€ ì˜ì¡´ì„± ì œì™¸ (ì„±ëŠ¥ ìµœì í™”)
  externals: {
    'better-sqlite3': 'commonjs better-sqlite3',  // ë„¤ì´í‹°ë¸Œ ëª¨ë“ˆ
    'node-notifier': 'commonjs node-notifier',    // ì‹œìŠ¤í…œ ì˜ì¡´ì„±
    'playwright': 'commonjs playwright'           // í° ì˜ì¡´ì„±
  }
};
```

**í•µì‹¬ ì„¤ê³„ ì›ì¹™:**
- **externals í™œìš©**: ë„¤ì´í‹°ë¸Œ ëª¨ë“ˆê³¼ í° ì˜ì¡´ì„±ì„ ë²ˆë“¤ì—ì„œ ì œì™¸
- **alias ì„¤ì •**: ê¹”ë”í•œ import ê²½ë¡œ
- **ì†ŒìŠ¤ë§µ ì¡°ê±´ë¶€ ì„¤ì •**: ê°œë°œ ì‹œì—ë§Œ í™œì„±í™”

### webpack.renderer.config.js ë¶„ì„

```javascript
const HtmlWebpackPlugin = require('html-webpack-plugin');
const path = require('path');

module.exports = {
  // ğŸ¯ React ì•± ì§„ì…ì 
  entry: './src/renderer/index.tsx',
  
  // ğŸ¯ ë¸Œë¼ìš°ì € í™˜ê²½ ì„¤ì •
  target: 'electron-renderer',
  
  mode: process.env.NODE_ENV || 'development',
  
  // ğŸ¯ TypeScript + React ì²˜ë¦¬
  module: {
    rules: [
      {
        test: /\.tsx?$/,
        include: /src/,
        use: [{ loader: 'ts-loader' }]
      },
      {
        test: /\.css$/,
        use: ['style-loader', 'css-loader', 'postcss-loader']
      },
      {
        test: /\.(png|jpe?g|gif|svg)$/,
        type: 'asset/resource'
      }
    ]
  },
  
  // ğŸ¯ ê°œë°œ ì„œë²„ ì„¤ì • (HMR í¬í•¨)
  devServer: {
    port: 3000,
    hot: true,                    // Hot Module Replacement
    historyApiFallback: true,     // SPA ë¼ìš°íŒ… ì§€ì›
    static: {
      directory: path.join(__dirname, 'dist'),
      publicPath: '/'
    }
  },
  
  // ğŸ¯ HTML ìë™ ìƒì„±
  plugins: [
    new HtmlWebpackPlugin({
      template: './src/renderer/index.html',
      inject: true
    })
  ],
  
  resolve: {
    extensions: ['.tsx', '.ts', '.js'],
    alias: {
      '@': path.resolve(__dirname, 'src'),
      '@shared': path.resolve(__dirname, 'src/shared')
    }
  },
  
  output: {
    path: path.resolve(__dirname, 'dist'),
    filename: 'renderer.js',
    publicPath: './'  // ë¡œì»¬ íŒŒì¼ ë¡œë”©ì„ ìœ„í•œ ìƒëŒ€ ê²½ë¡œ
  }
};
```

### package.json ìŠ¤í¬ë¦½íŠ¸ ë¶„ì„

```json
{
  "scripts": {
    // ğŸ”„ ê°œë°œ ëª¨ë“œ: Mainê³¼ Renderer ë™ì‹œ ì‹¤í–‰
    "dev": "concurrently \"npm run dev:renderer\" \"npm run dev:main\"",
    
    // ğŸ”§ Main Process: íŒŒì¼ ë³€ê²½ ê°ì§€ ë° ìë™ ë¹Œë“œ
    "dev:main": "cross-env NODE_ENV=development webpack --config webpack.main.config.js --mode development --watch",
    
    // ğŸŒ Renderer Process: ê°œë°œ ì„œë²„ (HMR í¬í•¨)
    "dev:renderer": "cross-env NODE_ENV=development webpack serve --config webpack.renderer.config.js --mode development",
    
    // ğŸ—ï¸ í”„ë¡œë•ì…˜ ë¹Œë“œ
    "build": "npm run build:main && npm run build:renderer",
    "build:main": "cross-env NODE_ENV=production webpack --config webpack.main.config.js --mode production",
    "build:renderer": "cross-env NODE_ENV=production webpack --config webpack.renderer.config.js --mode production",
    
    // ğŸš€ ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰
    "start": "electron ."
  }
}
```

## ì‹¤ìŠµ ì˜ˆì œ

### ì‹¤ìŠµ 1: ë¹Œë“œ ê³¼ì • ê´€ì°°

1. **ê°œë°œ ëª¨ë“œ ë¹Œë“œ ë¶„ì„:**
```bash
# Main Process ë¹Œë“œ (watch ëª¨ë“œ)
npm run dev:main

# ì¶œë ¥ íŒŒì¼ í™•ì¸
ls -la dist/
# main.js, preload.js, main.js.map, preload.js.map
```

2. **Renderer ê°œë°œ ì„œë²„ ì‹¤í–‰:**
```bash
# ê°œë°œ ì„œë²„ ì‹œì‘
npm run dev:renderer

# ë¸Œë¼ìš°ì €ì—ì„œ í™•ì¸: http://localhost:3000
# HMR í…ŒìŠ¤íŠ¸: ì»´í¬ë„ŒíŠ¸ íŒŒì¼ ìˆ˜ì • í›„ ìë™ ë¦¬ë¡œë“œ í™•ì¸
```

3. **í”„ë¡œë•ì…˜ ë¹Œë“œ ë¹„êµ:**
```bash
# í”„ë¡œë•ì…˜ ë¹Œë“œ
npm run build

# ë¹Œë“œ ê²°ê³¼ ë¶„ì„
ls -la dist/
wc -c dist/*.js  # íŒŒì¼ í¬ê¸° í™•ì¸
```

### ì‹¤ìŠµ 2: HMR (Hot Module Replacement) í…ŒìŠ¤íŠ¸

1. **React ì»´í¬ë„ŒíŠ¸ ìˆ˜ì •:**
```tsx
// src/renderer/components/StreamerCard.tsx ìˆ˜ì •
const StreamerCard: React.FC<StreamerCardProps> = ({ streamer }) => {
  return (
    <div className="glass-card p-4">
      {/* ğŸ”¥ ì´ í…ìŠ¤íŠ¸ë¥¼ ìˆ˜ì •í•´ë³´ì„¸ìš” */}
      <h3 className="text-lg font-bold text-cyan-400">
        HMR í…ŒìŠ¤íŠ¸: {streamer.name}
      </h3>
      {/* ... */}
    </div>
  );
};
```

2. **ë³€ê²½ ì‚¬í•­ ì‹¤ì‹œê°„ ë°˜ì˜ í™•ì¸:**
- íŒŒì¼ ì €ì¥ ì¦‰ì‹œ ë¸Œë¼ìš°ì € ìë™ ì—…ë°ì´íŠ¸
- ìƒíƒœ ìœ ì§€ë˜ë©´ì„œ UIë§Œ ë³€ê²½
- ì½˜ì†”ì—ì„œ HMR ë¡œê·¸ í™•ì¸

### ì‹¤ìŠµ 3: ë²ˆë“¤ ë¶„ì„ ë° ìµœì í™”

1. **webpack-bundle-analyzer ì„¤ì¹˜ ë° ì‚¬ìš©:**
```bash
npm install --save-dev webpack-bundle-analyzer

# webpack.renderer.config.jsì— í”ŒëŸ¬ê·¸ì¸ ì¶”ê°€
const BundleAnalyzerPlugin = require('webpack-bundle-analyzer').BundleAnalyzerPlugin;

plugins: [
  new BundleAnalyzerPlugin({
    analyzerMode: process.env.ANALYZE ? 'server' : 'disabled'
  })
]

# ë²ˆë“¤ ë¶„ì„ ì‹¤í–‰
ANALYZE=true npm run build:renderer
```

2. **ë²ˆë“¤ í¬ê¸° ìµœì í™”:**
```javascript
// webpack.renderer.config.js ìµœì í™” ì„¤ì •
module.exports = {
  optimization: {
    splitChunks: {
      chunks: 'all',
      cacheGroups: {
        vendor: {
          test: /[\\/]node_modules[\\/]/,
          name: 'vendors',
          chunks: 'all',
        },
      },
    },
  },
};
```

## ê³¼ì œ

### ê³¼ì œ 1: ì»¤ìŠ¤í…€ ë¹Œë“œ í™˜ê²½ êµ¬ì„±

ë‹¤ìŒ ìš”êµ¬ì‚¬í•­ì„ ë§Œì¡±í•˜ëŠ” ìƒˆë¡œìš´ ë¹Œë“œ í™˜ê²½ì„ êµ¬ì„±í•´ë³´ì„¸ìš”:

**ìš”êµ¬ì‚¬í•­:**
1. **ìŠ¤í…Œì´ì§• í™˜ê²½** ì¶”ê°€ (developmentì™€ production ì‚¬ì´)
2. **í™˜ê²½ë³„ ë‹¤ë¥¸ API ì—”ë“œí¬ì¸íŠ¸** ì„¤ì •
3. **ì¡°ê±´ë¶€ ê¸°ëŠ¥ í™œì„±í™”** (ê°œë°œ í™˜ê²½ì—ì„œë§Œ ë””ë²„ê·¸ ë©”ë‰´ í‘œì‹œ)

```javascript
// webpack.renderer.config.jsì— ì¶”ê°€í•  í™˜ê²½ë³„ ì„¤ì •
const webpack = require('webpack');

// í™˜ê²½ë³„ ì„¤ì •
const getEnvironmentConfig = () => {
  switch (process.env.NODE_ENV) {
    case 'development':
      return {
        API_BASE_URL: 'http://localhost:3001',
        ENABLE_DEBUG_MENU: true,
        LOG_LEVEL: 'debug'
      };
    case 'staging':
      return {
        API_BASE_URL: 'https://staging-api.example.com',
        ENABLE_DEBUG_MENU: true,
        LOG_LEVEL: 'info'
      };
    case 'production':
      return {
        API_BASE_URL: 'https://api.example.com',
        ENABLE_DEBUG_MENU: false,
        LOG_LEVEL: 'error'
      };
  }
};

// DefinePluginìœ¼ë¡œ í™˜ê²½ ë³€ìˆ˜ ì£¼ì…
plugins: [
  new webpack.DefinePlugin({
    'process.env.CONFIG': JSON.stringify(getEnvironmentConfig())
  })
]
```

### ê³¼ì œ 2: ì„±ëŠ¥ ìµœì í™” êµ¬í˜„

ë‹¤ìŒ ìµœì í™” ê¸°ë²•ë“¤ì„ ì ìš©í•´ë³´ì„¸ìš”:

1. **ì½”ë“œ ë¶„í•  (Code Splitting):**
```javascript
// ë™ì  importë¥¼ í™œìš©í•œ lazy loading
const LazyComponent = React.lazy(() => import('./components/HeavyComponent'));

// React.Suspenseë¡œ ë¡œë”© ì²˜ë¦¬
<Suspense fallback={<div>Loading...</div>}>
  <LazyComponent />
</Suspense>
```

2. **íŠ¸ë¦¬ ì‰ì´í‚¹ ìµœì í™”:**
```javascript
// package.jsonì— ì¶”ê°€
{
  "sideEffects": false  // ë¶€ì‘ìš© ì—†ëŠ” ëª¨ë“ˆì„ì„ ëª…ì‹œ
}

// lodash ë“± í° ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ í•„ìš”í•œ ë¶€ë¶„ë§Œ import
import { debounce } from 'lodash-es';  // ì „ì²´ import ëŒ€ì‹ 
```

3. **ì—ì…‹ ìµœì í™”:**
```javascript
// webpack.renderer.config.jsì— ì´ë¯¸ì§€ ìµœì í™” ì¶”ê°€
{
  test: /\.(png|jpe?g|gif|svg)$/,
  type: 'asset',
  parser: {
    dataUrlCondition: {
      maxSize: 8 * 1024  // 8KB ë¯¸ë§Œì€ base64ë¡œ ì¸ë¼ì¸
    }
  }
}
```

### ê³¼ì œ 3: ê°œë°œ ë„êµ¬ í†µí•©

ê°œë°œ ê²½í—˜ì„ í–¥ìƒì‹œí‚¤ëŠ” ë„êµ¬ë“¤ì„ í†µí•©í•´ë³´ì„¸ìš”:

1. **ESLint + Prettier í†µí•©:**
```json
// package.json scriptsì— ì¶”ê°€
{
  "scripts": {
    "lint": "eslint src --ext .ts,.tsx",
    "lint:fix": "eslint src --ext .ts,.tsx --fix",
    "format": "prettier --write \"src/**/*.{ts,tsx}\""
  }
}
```

2. **TypeScript íƒ€ì… ì²´í¬:**
```bash
# ë¹Œë“œì™€ ë³„ë„ë¡œ íƒ€ì… ì²´í¬ ì‹¤í–‰
npx tsc --noEmit
```

3. **ìë™í™”ëœ ê°œë°œ ì›Œí¬í”Œë¡œìš°:**
```json
// package.jsonì— ì¶”ê°€
{
  "scripts": {
    "dev:full": "concurrently \"npm run dev:main\" \"npm run dev:renderer\" \"npm run type-check:watch\"",
    "type-check:watch": "tsc --noEmit --watch"
  }
}
```

## ì¶”ê°€ í•™ìŠµ ìë£Œ

### Webpack ì‹¬í™”
- [Webpack ê³µì‹ ê°€ì´ë“œ](https://webpack.js.org/guides/)
- [Electron Webpack ì„¤ì •](https://webpack.js.org/configuration/target/)
- [ì½”ë“œ ë¶„í•  ì „ëµ](https://webpack.js.org/guides/code-splitting/)

### ì„±ëŠ¥ ìµœì í™”
- [ì›¹ ì„±ëŠ¥ ìµœì í™”](https://developers.google.com/web/fundamentals/performance)
- [ë²ˆë“¤ ë¶„ì„ ë„êµ¬](https://github.com/webpack-contrib/webpack-bundle-analyzer)

### ê°œë°œ ë„êµ¬
- [Hot Module Replacement](https://webpack.js.org/concepts/hot-module-replacement/)
- [ESLint + TypeScript ì„¤ì •](https://typescript-eslint.io/)

### ë‹¤ìŒ í•™ìŠµ ì˜ˆê³ 
**7ì¼ì°¨ì—ì„œëŠ” 1ì£¼ì°¨ ì¢…í•© ì‹¤ìŠµìœ¼ë¡œ ë¯¸ë‹ˆ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•©ë‹ˆë‹¤. ì§€ê¸ˆê¹Œì§€ í•™ìŠµí•œ ëª¨ë“  ë‚´ìš©ì„ í™œìš©í•˜ì—¬ ê°„ë‹¨í•œ Electron ì•±ì„ ì²˜ìŒë¶€í„° ë§Œë“¤ì–´ë´…ë‹ˆë‹¤.**

---
*ğŸ¯ í•™ìŠµ íŒ: ë¹Œë“œ ì‹œìŠ¤í…œì€ ê°œë°œ ìƒì‚°ì„±ì— ì§ì ‘ì ì¸ ì˜í–¥ì„ ë¯¸ì¹©ë‹ˆë‹¤. ê° ì„¤ì •ì˜ ì˜ë¯¸ë¥¼ ì´í•´í•˜ê³ , í”„ë¡œì íŠ¸ ìš”êµ¬ì‚¬í•­ì— ë§ê²Œ ìµœì í™”í•˜ëŠ” ëŠ¥ë ¥ì„ ê¸°ë¥´ëŠ” ê²ƒì´ ì¤‘ìš”í•´ìš”!*